{% extends "layout.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<div class="container">
  <!-- Hero Section with Profile Picture -->
  <div style="background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-dark) 100%); border-radius: 12px; padding: 40px; margin-bottom: 24px; text-align: center; color: white;">
    <div style="display: flex; flex-direction: column; align-items: center; gap: 16px;">
      {% if current_user.profile_picture %}
      <img src="{{ url_for('static', filename='uploads/' + current_user.profile_picture) }}" alt="{{ current_user.username }}" style="width: 160px; height: 160px; border-radius: 50%; object-fit: cover; border: 4px solid white; box-shadow: 0 8px 24px rgba(0,0,0,0.2);" />
      {% else %}
      <div style="width: 160px; height: 160px; border-radius: 50%; background: var(--accent-color); display: flex; align-items: center; justify-content: center; color: white; font-size: 72px; font-weight: bold; border: 4px solid white; box-shadow: 0 8px 24px rgba(0,0,0,0.2);">
        {{ (current_user.username or 'U')[:1].upper() }}
      </div>
      {% endif %}
      <div>
        <h1 style="margin: 0 0 8px 0; font-size: 32px; font-weight: 700;">Welcome back, {{ current_user.username }}! ğŸ‘‹</h1>
        <p style="margin: 0 0 12px 0; font-size: 18px; opacity: 0.95;">{{ current_user.course or 'Student Portfolio' }}</p>
        {% if current_user.bio %}
        <p style="margin: 0; font-size: 14px; opacity: 0.85; max-width: 500px;">{{ current_user.bio }}</p>
        {% endif %}
      </div>
    </div>
  </div>

  <h2 class="page-title" style="margin-top: 0;">Dashboard Overview</h2>
  <p class="text-muted" style="margin-bottom: 12px;">Here's an overview of your portfolio</p>

  <!-- Dashboard Stats -->
  <div class="dashboard-stats">
    <div class="stat-card">
      <h3>{{ projects|length }}</h3>
      <p>Projects</p>
    </div>
    <div class="stat-card">
      <h3>âœ“</h3>
      <p>Status: Active</p>
    </div>
    <div class="stat-card">
      <h3>{{ (current_user.course or 'N/A')[:10] }}</h3>
      <p>Course</p>
    </div>
  </div>

  <!-- Quick Action Buttons -->
  <div style="display:flex; gap:8px; margin:16px 0; flex-wrap:wrap;">
    <a href="{{ url_for('projects') }}" class="btn btn-success" style="flex:1; min-width:140px;">â• Add Project</a>
    <a href="{{ url_for('public_portfolio', username=current_user.username) }}" target="_blank" class="btn btn-primary" style="flex:1; min-width:140px;">ğŸ‘ï¸ View Portfolio</a>
    <a href="{{ url_for('profile') }}" class="btn btn-secondary" style="flex:1; min-width:140px;">âš™ï¸ Edit Profile</a>
  </div>

  <!-- Profile Summary Section -->
  <div class="card" style="margin-top:24px; background: #f1f5f9; border: 1px solid #e2e8f0;">
    <div style="display:flex; align-items:center; gap:16px;">
      {% if current_user.profile_picture %}
      <img src="{{ url_for('static', filename='uploads/' + current_user.profile_picture) }}" alt="{{ current_user.username }}" style="width:80px; height:80px; border-radius:50%; object-fit:cover; flex-shrink:0; border:3px solid var(--accent-color);" />
      {% else %}
      <div style="width:80px; height:80px; border-radius:50%; background:linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%); display:flex; align-items:center; justify-content:center; color:white; font-size:32px; font-weight:bold; flex-shrink:0;">
        {{ (current_user.username or 'U')[:1].upper() }}
      </div>
      {% endif %}
      <div style="flex:1;">
        <h3 style="margin:0 0 4px 0; color:var(--primary-color);">{{ current_user.username }}</h3>
        <p style="margin:0 0 6px 0; color:var(--muted); font-size:14px;">{{ current_user.course or 'Student' }}</p>
        {% if current_user.bio %}
        <p style="margin:0; color:var(--muted); font-size:13px; line-height:1.5;">{{ current_user.bio }}</p>
        {% else %}
        <p style="margin:0; color:var(--muted); font-size:13px; font-style:italic;">No bio yet. <a href="{{ url_for('profile') }}" style="color:var(--primary-color); font-weight:600;">Add one â†’</a></p>
        {% endif %}
      </div>
      <div style="flex-shrink:0;">
        <a href="{{ url_for('profile') }}" class="btn btn-primary">Edit</a>
      </div>
    </div>
  </div>

  <!-- Your Projects Section -->
  <h3 style="margin-bottom:12px; margin-top:24px; color:var(--primary-color);">Your Recent Projects</h3>
  {% if projects %}
  <div style="display:flex; flex-direction:column; gap:12px;">
    {% for p in projects %}
    <div class="list-card">
      <div class="project-thumbnail">
        {% if p.image_file %}
        <img src="{{ url_for('static', filename='uploads/' + p.image_file) }}" alt="{{ p.title }}" style="width:100%; height:100%; object-fit:cover;" />
        {% else %}
        <div class="no-image">No Image</div>
        {% endif %}
      </div>

      <div style="flex:1; min-width:0;">
        <h4 style="margin:0 0 5px 0; color:var(--primary-color);">{{ p.title }}</h4>
        <p class="muted small" style="margin:0 0 6px 0;">{{ (p.description or '')[:80] }}{% if p.description and p.description|length > 80 %}...{% endif %}</p>
        <p class="text-muted" style="font-size:12px; margin:0;">ğŸ“… {{ p.date_posted.strftime('%b %d, %Y') }}</p>
      </div>

      <div style="flex-shrink:0;">
        <a href="{{ url_for('edit_project', id=p.id) }}" class="btn btn-primary">Edit</a>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="card text-center">
    <p class="text-muted" style="margin:0;">You haven't created any projects yet.</p>
    <p style="margin-top:10px;"><a href="{{ url_for('projects') }}" class="text-primary" style="font-weight:600;">Create your first project â†’</a></p>
  </div>
  {% endif %}
</div>
{% endblock %}
