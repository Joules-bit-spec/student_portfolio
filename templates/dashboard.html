{% extends "layout.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<div class="container">
  <h2 class="page-title">Welcome back, {{ current_user.username }}! ğŸ‘‹</h2>
  <p class="text-muted" style="margin-bottom: 20px;">Here's an overview of your portfolio</p>

  <!-- Dashboard Stats -->
  <div class="dashboard-stats">
    <div class="stat-card">
      <h3>{{ projects|length }}</h3>
      <p>Projects</p>
    </div>
    <div class="stat-card">
      <h3>âœ“</h3>
      <p>Status: Active</p>
    </div>
    <div class="stat-card">
      <h3>{{ current_user.course[:10] or 'N/A' }}</h3>
      <p>Course</p>
    </div>
  </div>

  <!-- Quick Action Buttons -->
  <div style="display:flex; gap:10px; margin:20px 0; flex-wrap:wrap;">
    <a href="{{ url_for('projects') }}" class="btn btn-success" style="flex:1; min-width:150px;">â• Add Project</a>
    <a href="{{ url_for('public_portfolio', username=current_user.username) }}" target="_blank" class="btn btn-primary" style="flex:1; min-width:150px;">ğŸ‘ï¸ View Portfolio</a>
    <a href="{{ url_for('profile') }}" class="btn btn-secondary" style="flex:1; min-width:150px;">âš™ï¸ Edit Profile</a>
  </div>

  <!-- Your Projects Section -->
  <h3 style="margin-bottom:12px;">Your Recent Projects</h3>
  {% if projects %}
  <div style="display:flex; flex-direction:column; gap:12px;">
    {% for p in projects %}
    <div class="list-card">
      <div style="width:80px; height:80px; flex-shrink:0; border-radius:6px; overflow:hidden; display:flex; align-items:center; justify-content:center; background:#f0f0f0;">
        {% if p.image_file %}
        <img src="{{ url_for('static', filename='uploads/' + p.image_file) }}" alt="{{ p.title }}" style="width:100%; height:100%; object-fit:cover;" />
        {% else %}
        <div class="no-image">No Image</div>
        {% endif %}
      </div>

      <div style="flex:1; min-width:0;">
        <h4 style="margin:0 0 5px 0;">{{ p.title }}</h4>
        <p class="muted small" style="margin:0 0 8px 0;">{{ p.description[:80] }}{% if p.description|length > 80 %}...{% endif %}</p>
        <p class="text-muted" style="font-size:12px; margin:0;">ğŸ“… {{ p.date_posted.strftime('%b %d, %Y') }}</p>
      </div>

      <div style="flex-shrink:0;">
        <a href="{{ url_for('edit_project', id=p.id) }}" class="btn btn-primary">Edit</a>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="card text-center">
    <p class="text-muted" style="margin:0;">You haven't created any projects yet.</p>
    <p style="margin-top:10px;"><a href="{{ url_for('projects') }}" class="text-primary" style="font-weight:600;">Create your first project â†’</a></p>
  </div>
  {% endif %}
</div>
{% endblock %}
