{% extends "layout.html" %}

{% block title %}{{ user.username }}'s Portfolio{% endblock %}

{% block content %}
<div class="container" style="max-width:900px; margin:0 auto; padding:20px;">
  <!-- Header -->
  <div class="profile-header text-center" style="margin-bottom:24px;">
    <h1 style="margin:0 0 8px 0;">{{ user.username }}'s Portfolio</h1>
    <p class="text-muted" style="margin:0;">{{ user.course or 'Student' }}</p>
    {% if user.bio %}
    <p style="max-width:640px; margin:12px auto 0; color:var(--dark-text);">{{ user.bio }}</p>
    {% endif %}
  </div>

  <!-- Add Project (owner only) -->
  {% if current_user.is_authenticated and current_user.id == user.id %}
  <div class="card" style="padding:20px; margin-bottom:24px;">
    <h3 style="margin-top:0; margin-bottom:12px; color:var(--primary-color);">âž• Add New Project</h3>
    <form method="POST" enctype="multipart/form-data">
      <div class="form-group">
        <label for="title">Title *</label>
        <input type="text" id="title" name="title" required />
      </div>
      <div class="form-group">
        <label for="description">Description *</label>
        <textarea id="description" name="description" rows="4" required></textarea>
      </div>
      <div class="form-group">
        <label for="image">Project Image</label>
        <input type="file" id="image" name="image" accept="image/*" />
      </div>
      <button type="submit" class="btn btn-primary">Add Project</button>
    </form>
  </div>
  {% endif %}

  <!-- Projects -->
  <h3 style="margin-bottom:12px;">Projects</h3>
  {% if projects %}
  <div class="projects-grid">
    {% for p in projects %}
    <article class="project-card">
      <div class="project-thumbnail">
        {% if p.image_file %}
        <img src="{{ url_for('static', filename='uploads/' + p.image_file) }}" alt="{{ p.title }}">
        {% else %}
        <div class="no-image">No Image</div>
        {% endif %}
      </div>
      <div class="project-body">
        <h4>{{ p.title }}</h4>
        <p class="muted small">{{ p.description[:140] }}{% if p.description|length > 140 %}...{% endif %}</p>
        <p class="text-muted" style="font-size:12px;">ðŸ“… {{ p.date_posted.strftime('%b %d, %Y') }}</p>
      </div>
      {% if current_user.is_authenticated and current_user.id == user.id %}
      <div class="project-actions">
        <a href="{{ url_for('edit_project', id=p.id) }}" class="btn btn-primary">Edit</a>
        <a href="{{ url_for('delete_project', id=p.id) }}" class="btn btn-danger" onclick="return confirm('Delete this project?')">Delete</a>
      </div>
      {% endif %}
    </article>
    {% endfor %}
  </div>
  {% else %}
  <div class="card text-center" style="padding:28px;">
    <p class="text-muted">No projects yet.</p>
    {% if current_user.is_authenticated and current_user.id == user.id %}
    <p style="margin-top:10px;"><a href="{{ url_for('projects') }}" class="text-primary">Create your first project â†’</a></p>
    {% endif %}
  </div>
  {% endif %}
</div>

{% endblock %}
